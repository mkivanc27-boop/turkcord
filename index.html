<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TurkCord</title>

<style>
body{
margin:0;
font-family:sans-serif;
background:#1e1f22;
color:white;
}

.screen{
height:100vh;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
gap:10px;
}

input{
padding:10px;
width:250px;
border-radius:6px;
border:none;
background:#2b2d31;
color:white;
}

button{
padding:10px 15px;
border:none;
border-radius:6px;
background:#5865f2;
color:white;
cursor:pointer;
}

.link{
color:#5865f2;
cursor:pointer;
font-size:14px;
}
</style>

</head>
<body>

<!-- LOGIN -->

<div id="loginScreen" class="screen">

<h2>Login</h2>

<input id="loginEmail" placeholder="Email">
<input id="loginPassword" type="password" placeholder="Åifre">

<button onclick="login()">GiriÅŸ</button>

<div>
HesabÄ±n yok mu?
<span class="link" onclick="showRegister()">KayÄ±t Ol</span>
</div>

</div>

<!-- REGISTER -->

<div id="registerScreen" class="screen" style="display:none;">

<h2>KayÄ±t Ol</h2>

<input id="registerUsername" placeholder="KullanÄ±cÄ± AdÄ±">
<input id="registerEmail" placeholder="Email">
<input id="registerPassword" type="password" placeholder="Åifre">

<button onclick="register()">KayÄ±t Ol</button>

<div>
Zaten hesabÄ±n var mÄ±?
<span class="link" onclick="showLogin()">GiriÅŸ Yap</span>
</div>

</div>

<!-- APP -->

<div id="app" style="display:none; padding:20px;">

<h2>ğŸ‰ GiriÅŸ BaÅŸarÄ±lÄ±</h2>

<button onclick="logout()">Logout</button>

<hr>

<h3>Server OluÅŸtur</h3>

<input id="serverName" placeholder="Server adÄ±">
<button onclick="createServer()">OluÅŸtur</button>

<div id="serverList"></div>

</div>


<script type="module">

/* ğŸ”¥ FIREBASE */

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
getAuth,
createUserWithEmailAndPassword,
signInWithEmailAndPassword,
signOut
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import {
getFirestore,
doc,
setDoc,
collection,
addDoc,
onSnapshot
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";


/* ğŸ”´ CONFIG */

const firebaseConfig = {
apiKey: "AIzaSyC98wxJQk8yNZFdE-OJ1Tlpy1ANuaRUT14",
authDomain: "turkcord-47b24.firebaseapp.com",
projectId: "turkcord-47b24",
storageBucket: "turkcord-47b24.firebasestorage.app",
messagingSenderId: "474688300925",
appId: "1:474688300925:web:75d8d4c690b92c7d438e14"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);


/* ================= SCREEN SWITCH ================= */

window.showRegister = ()=>{
document.getElementById("loginScreen").style.display="none";
document.getElementById("registerScreen").style.display="flex";
};

window.showLogin = ()=>{
document.getElementById("loginScreen").style.display="flex";
document.getElementById("registerScreen").style.display="none";
};


/* ================= REGISTER ================= */

window.register = async()=>{
try{

const username = document.getElementById("registerUsername").value;
const email = document.getElementById("registerEmail").value;
const password = document.getElementById("registerPassword").value;

const user = await createUserWithEmailAndPassword(auth,email,password);

await setDoc(doc(db,"users",user.user.uid),{
username:username,
email:email
});

alert("KayÄ±t BaÅŸarÄ±lÄ±");

document.getElementById("registerScreen").style.display="none";
document.getElementById("app").style.display="block";

}catch(err){
alert("Register Hata:\n"+err.message);
}
};


/* ================= LOGIN ================= */

window.login = async()=>{
try{

const email = document.getElementById("loginEmail").value;
const password = document.getElementById("loginPassword").value;

await signInWithEmailAndPassword(auth,email,password);

alert("Login BaÅŸarÄ±lÄ±");

document.getElementById("loginScreen").style.display="none";
document.getElementById("app").style.display="block";

}catch(err){
alert("Login Hata:\n"+err.message);
}
};


/* ================= LOGOUT ================= */

window.logout = async()=>{
await signOut(auth);

document.getElementById("app").style.display="none";
document.getElementById("loginScreen").style.display="flex";
};


/* ================= SERVER ================= */

window.createServer = async()=>{
const name = document.getElementById("serverName").value;
if(!name) return;

await addDoc(collection(db,"servers"),{
name:name,
owner:auth.currentUser.uid
});

document.getElementById("serverName").value="";
};


/* ================= LOAD SERVERS ================= */

onSnapshot(collection(db,"servers"),snap=>{
const serverList = document.getElementById("serverList");
serverList.innerHTML="";

snap.forEach(docSnap=>{
const data = docSnap.data();

const div=document.createElement("div");
div.style.background="#2b2d31";
div.style.padding="8px";
div.style.marginTop="6px";
div.style.borderRadius="6px";
div.innerText=data.name;

serverList.appendChild(div);
});
});

</script>

</body>
</html>
