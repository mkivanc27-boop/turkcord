<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TurboCord</title>

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:Segoe UI, Arial;
}

body{
background:#313338;
color:white;
height:100vh;
overflow:hidden;
}

/* LOGIN */

#loginScreen{
height:100vh;
display:flex;
flex-direction:column;
justify-content:center;
align-items:center;
background:#1e1f22;
}

#loginScreen input{
margin:6px;
padding:12px;
width:260px;
border-radius:8px;
border:none;
outline:none;
}

#loginScreen button{
padding:12px;
width:260px;
border:none;
border-radius:8px;
background:#5865f2;
color:white;
cursor:pointer;
}

/* APP */

#app{
display:none;
height:100vh;
width:100%;
}

/* SERVER BAR */

#servers{
width:72px;
background:#202225;
display:flex;
flex-direction:column;
align-items:center;
padding-top:10px;
gap:10px;
flex-shrink:0;
}

.server{
width:48px;
height:48px;
border-radius:50%;
background:#2b2d31;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
transition:0.2s;
}

.server:hover{
background:#5865f2;
transform:scale(1.1);
}

/* SIDEBAR */

#sidebar{
width:240px;
background:#2b2d31;
padding:10px;
overflow:auto;
flex-shrink:0;
border-right:1px solid #202225;
}

.sidebar-item{
padding:8px;
border-radius:6px;
cursor:pointer;
transition:0.2s;
}

.sidebar-item:hover{
background:#40444b;
}

/* CHAT */

#chat{
flex:1;
display:flex;
flex-direction:column;
overflow:hidden;
}

#messages{
flex:1;
overflow:auto;
padding:15px;
display:flex;
flex-direction:column;
gap:8px;
}

.message{
background:#40444b;
padding:10px;
border-radius:10px;
max-width:60%;
}

.message.me{
background:#5865f2;
align-self:flex-end;
}

/* INPUT */

#input{
display:flex;
padding:10px;
background:#2b2d31;
gap:10px;
}

#input input{
flex:1;
padding:10px;
border-radius:8px;
border:none;
background:#40444b;
color:white;
}

#input button{
padding:10px 15px;
border:none;
border-radius:8px;
background:#5865f2;
color:white;
cursor:pointer;
}

</style>
</head>
<body>

<!-- LOGIN -->
<div id="loginScreen">
<h2>TurboCord Login</h2>

<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">

<button onclick="login()">Login / Register</button>
</div>

<!-- APP -->
<div id="app">

<div id="servers">
<div class="server" onclick="createServer()">+</div>
<div id="serverList"></div>
</div>

<div id="sidebar">
<h3>Channels</h3>
<div id="channelList"></div>

<hr>

<h3>Members</h3>
<div id="memberList"></div>
</div>

<div id="chat">
<div id="messages"></div>

<div id="input">
<input id="messageInput" placeholder="Write message">
<button onclick="sendMessage()">Send</button>
</div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-analytics.js";
import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot, query, where, orderBy } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* ðŸ”¥ SENÄ°N FIREBASE BÄ°LGÄ°LERÄ°N */

const firebaseConfig = {
apiKey: "AIzaSyC98wxJQk8yNZFdE-OJ1Tlpy1ANuaRUT14",
authDomain: "turkcord-47b24.firebaseapp.com",
projectId: "turkcord-47b24",
storageBucket: "turkcord-47b24.firebasestorage.app",
messagingSenderId: "474688300925",
appId: "1:474688300925:web:316134db4b4cb441438e14",
measurementId: "G-S92JHCM9P9"
};

/* INIT */

const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
const auth = getAuth(app);
const db = getFirestore(app);

let currentRoom=null;

/* ================= AUTH ================= */

window.login = async()=>{

const email = email.value;
const pass = password.value;

try{
await signInWithEmailAndPassword(auth,email,pass);
}
catch{
await createUserWithEmailAndPassword(auth,email,pass);
}

};

onAuthStateChanged(auth,user=>{

if(user){
loginScreen.style.display="none";
app.style.display="flex";
loadServers();
}
else{
loginScreen.style.display="flex";
app.style.display="none";
}

});

/* ================= SERVER ================= */

window.createServer = async()=>{

const name = prompt("Server name");
if(!name) return;

await addDoc(collection(db,"servers"),{
name:name,
owner:auth.currentUser.uid,
members:[auth.currentUser.uid]
});

};

function loadServers(){

onSnapshot(collection(db,"servers"),snap=>{

serverList.innerHTML="";

snap.forEach(doc=>{

const data = doc.data();

if(!data.members?.includes(auth.currentUser.uid)) return;

const div=document.createElement("div");
div.className="server";
div.innerText=data.name[0];

div.onclick=()=>{
currentRoom=doc.id;
loadMessages();
};

serverList.appendChild(div);

});

});

}

/* ================= MESSAGES ================= */

window.sendMessage = async()=>{

if(!currentRoom) return;

await addDoc(collection(db,"messages"),{
room:currentRoom,
text:messageInput.value,
uid:auth.currentUser.uid,
email:auth.currentUser.email,
time:Date.now()
});

messageInput.value="";

};

function loadMessages(){

const q=query(
collection(db,"messages"),
where("room","==",currentRoom),
orderBy("time")
);

onSnapshot(q,snap=>{

messages.innerHTML="";

snap.forEach(doc=>{

const data = doc.data();

const div=document.createElement("div");
div.className="message";

if(data.uid===auth.currentUser.uid){
div.classList.add("me");
}

div.innerText=data.email+": "+data.text;

messages.appendChild(div);

});

messages.scrollTop=messages.scrollHeight;

});

}

</script>

</body>
</html>
