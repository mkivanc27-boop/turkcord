<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TurkCord V1</title>

<style>
body{
margin:0;
background:#1e1f22;
color:white;
font-family:sans-serif;
}

/* LAYOUT */

#appLayout{
display:flex;
height:100vh;
}

/* SERVER SIDEBAR */

#serverSidebar{
width:80px;
background:#111214;
display:flex;
flex-direction:column;
align-items:center;
padding-top:10px;
gap:10px;
overflow-y:auto;
}

.serverCircle{
width:50px;
height:50px;
border-radius:50%;
background:#5865f2;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
font-weight:bold;
}

.serverCircle.active{
border:3px solid #00aaff;
}

/* CHANNEL AREA */

#channelPanel{
width:250px;
background:#2b2d31;
padding:10px;
overflow-y:auto;
}

.channelItem{
padding:6px;
background:#3a3c41;
margin-top:6px;
border-radius:6px;
cursor:pointer;
}

#chatArea{
flex:1;
background:#1e1f22;
padding:20px;
overflow-y:auto;
}

input{
padding:8px;
border-radius:6px;
border:none;
background:#2b2d31;
color:white;
}

button{
padding:8px 12px;
border:none;
border-radius:6px;
background:#5865f2;
color:white;
cursor:pointer;
}
</style>

</head>
<body>

<!-- LOGIN SCREEN -->

<div id="authScreen" style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;gap:10px;">

<h2>Login</h2>

<input id="loginEmail" placeholder="Email">
<input id="loginPassword" type="password" placeholder="Åžifre">

<button onclick="login()">GiriÅŸ</button>

<p>HesabÄ±n yok mu? <span style="color:#5865f2;cursor:pointer;" onclick="showRegister()">KayÄ±t Ol</span></p>

</div>

<!-- REGISTER -->

<div id="registerScreen" style="display:none;flex-direction:column;align-items:center;justify-content:center;height:100vh;gap:10px;">

<h2>KayÄ±t</h2>

<input id="registerUsername" placeholder="KullanÄ±cÄ± AdÄ±">
<input id="registerEmail" placeholder="Email">
<input id="registerPassword" type="password" placeholder="Åžifre">

<button onclick="register()">KayÄ±t Ol</button>

<p onclick="showLogin()" style="color:#5865f2;cursor:pointer;">Geri DÃ¶n</p>

</div>

<!-- APP -->

<div id="app" style="display:none;">

<div id="appLayout">

<div id="serverSidebar"></div>

<div id="channelPanel">
<h3>Kanallar</h3>
<div id="channelList"></div>
<button onclick="createChannel()">+ Kanal</button>
</div>

<div id="chatArea">
<h2 id="selectedServerName">Server</h2>
<div id="messages"></div>
</div>

</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* ðŸ”¥ CONFIG */

const firebaseConfig = {
apiKey:"AIzaSyC98wxJQk8yNZFdE-OJ1Tlpy1ANuaRUT14",
authDomain:"turkcord-47b24.firebaseapp.com",
projectId:"turkcord-47b24",
storageBucket:"turkcord-47b24.firebasestorage.app",
messagingSenderId:"474688300925",
appId:"1:474688300925:web:75d8d4c690b92c7d438e14"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let selectedServer = null;

/* AUTH */

window.login = async()=>{
const email = loginEmail.value;
const pass = loginPassword.value;

await signInWithEmailAndPassword(auth,email,pass);

authScreen.style.display="none";
app.style.display="block";

loadServers();
};

window.register = async()=>{
const user = await createUserWithEmailAndPassword(auth,registerEmail.value,registerPassword.value);

await setDoc(doc(db,"users",user.user.uid),{
username:registerUsername.value
});

alert("KayÄ±t baÅŸarÄ±lÄ±");
};

window.showRegister=()=>{
authScreen.style.display="none";
registerScreen.style.display="flex";
};

window.showLogin=()=>{
registerScreen.style.display="none";
authScreen.style.display="flex";
};

/* SERVER */

function loadServers(){

onSnapshot(collection(db,"servers"),snap=>{

serverSidebar.innerHTML="";

snap.forEach(docSnap=>{

const data=docSnap.data();

const div=document.createElement("div");
div.className="serverCircle";
div.innerText=data.name.charAt(0);

div.onclick=()=>{
selectedServer=docSnap.id;
document.getElementById("selectedServerName").innerText=data.name;
loadChannels();
};

serverSidebar.appendChild(div);

});

});

}

window.createServer=async()=>{
const name=prompt("Server adÄ±");
if(!name) return;

await addDoc(collection(db,"servers"),{
name:name,
owner:auth.currentUser.uid
});

};

/* CHANNEL */

window.createChannel=async()=>{
if(!selectedServer) return;

const name=prompt("Kanal adÄ±");
if(!name) return;

await addDoc(collection(db,"servers",selectedServer,"channels"),{
name:name,
type:"text"
});
};

function loadChannels(){

if(!selectedServer) return;

onSnapshot(collection(db,"servers",selectedServer,"channels"),snap=>{

channelList.innerHTML="";

snap.forEach(docSnap=>{

const data=docSnap.data();

const div=document.createElement("div");
div.className="channelItem";
div.innerText="# "+data.name;

channelList.appendChild(div);

});

});

}

</script>

</body>
</html>
